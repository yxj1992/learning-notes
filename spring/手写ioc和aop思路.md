### 手写IOC和AOP思路  
#### IOC大致思路如下：

1、建立自己的创建Bean的注解和输出Bean的注解。分别用于Bean头部初始化Bean、字段标识获取Bean。建立自己的初始化接口。用于实现Bean被加载完后执行init方法。

2、用包扫描器扫描监管范围内所有的class、并通过反射扫描所有类是否包含创建Bean的注解进行初始化操作并存储至Bean容器

3、从Bean容器获得所有Bean、并通过反射扫描所有Bean的所有字段是否包含的输出Bean的注解进行赋值操作

4、从Bean容器获得所有Bean、判断是否实现初始化接口并执行init方法。

 

#### AOP大致思路如下：

1、创建自己的Around注解，注解参数为Class。创建Aop方法存储容器。本处仅实现环绕通知。

2、在IOC创建Bean之前，优先扫描包下所有类的所有方法，把包含Around注解方法存储至容器。

3、在IOC扫描Bean的时候，检索Bean内部是否包含注解其类型为Around注明的Class。并选择性进行IOC是否需要代理

4、在需要代理的场景下进行切面的调用整合。执行前后进行控制。

 

#### MVC大致实现思路如下：

1、创建MVC地址映射相关注解、创建Json输出注解

2、整改IOC，在进行输出Bean之后进行mvc注解扫描。将映射地址和方法存储至mapping容器

3、创建Listen并实现ServletContextListener

4、覆盖contextInitialized方法。接受参数并投递给如上实现的IOC+AOP入口进行加载

5、新建分发器：DispatServlet，在该servlet通过mapping容器获取到Bean、方法

6、新建参数适配器，通过第5步获取到的方法。基于反射技术装载参数并调用执行。

7、执行完成后得到的结果。通过Json输出或转向到模板地址    

#### 事物管理的实现：  

1、新建事物管理注解

2、基于如上功能，新建切面，拦截事物管理注解

3、在切面内部。利用线程容器进行控制，是否需要事物。则写入标识

4、在ORM层，优先从线程容器获得连接，没有则创建，并与数据源绑定存储至线程容器，用同一个连接操作数据源。

5、在切面处调用完实际方法后，有报错则关闭连接，无报错则提交事物并关闭连接。

#### 参考资料  
- [手写Spring基本体系IOC+AOP+MVC+事物管理等简单实现](https://my.oschina.net/hooker/blog/1627050)